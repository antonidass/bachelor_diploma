\chapter{Технологический раздел}
В данном разделе описываются средства, используемые для разработки
программного обеспечения. Приводятся детали реализации программных компонентов и процесс
обучения разрабатываемой нейронной сети.

\section{Средства реализации программного комплекса}

\subsection{Выбор языка программирования}
Для написания программного обеспечения будет использоваться язык программирования Python \cite[]{python} версии 3.11.

Данный выбор обусловлен следующими факторами:
\begin{itemize}
    \item наличие большого количества библиотек для работы с нейронными сетями;
    \item кроссплатформенность;
    \item автоматическое управление памятью.
\end{itemize}

\subsection{Используемые библиотеки}
При разработке программного обеспечения использовались следующие
библиотеки:
\begin{itemize}
    \item PyTorch \cite{torch} --- библиотека, для создания и обучения модели нейронной сети. Основным преимуществом PyTorch является гибкость. PyTorch предоставляет множество инструментов для разработки своих моделей, включая выбор оптимизаторов, функций потерь и слоев;
    \item PyQt5 \cite{pyqt} --- библиотека для создания графического интерфейса;
    \item Scikit-learn \cite{scikit}  --- библиотека включает в себя подготовку данных для последующей классификации, а также различные алгоритмы машинного обучения и поддерживает взаимодействие с NumPy;
    \item Numpy \cite{numpy} --- это библиотека, которая предоставляет функциональность для работы с многомерными массивами и матрицами. Она используется для научных вычислений, обработки данных и машинного обучения;
    \item Matplotlib \cite{matplot} --- библиотека для визуализация результатов экспериментов и исследований, создание диаграмм и др.
\end{itemize}

\section{Минимальные требования к вычислительной системе}
Для того, чтобы воспользоваться программным обеспечением, потребуется
ЭВМ с предустановленным интерпретатором Python версии 3.11. Также необходимо
скачать и установить все использованные в проекте библиотеки.

Требования к использованию определенной операционной системы отсутствуют поскольку  ПО реализовано на языке Python,
который является кроссплатформенным.


\section{Формат входных данных}
Входными данными являются текстовые файл в формате CSV.
CSV --- формат текстовых данных в котором каждая строка --- это отдельная строка таблицы, а столбцы
отделены один от другого специальными символами-разделителями --- запятыми.
Файл CSV содержит информацию о сетевых параметрах.
Файлы данного формата могут быть открыты на любой операционной системе в
любом программном обеспечении для работы с текстом.

\section{Формат выходных данных}

Выходные данные модуля классификации можно условно разделить на два
типа:
    \begin{itemize}
        \item прогнозирование класса атаки для каждой строки из входного файла;
        \item визуализация количества атак принадлежащих к различным классов сетевых атак.
    \end{itemize}
Полученные выходные данные выводятся на графический интерфейс
программного обеспечения


\section{Структура разработанного ПО}
Структура разработанного ПО изображена на рисунке \ref*{img:modules}.

\imgs{modules}{H}{1}{Диаграмма структуры ПО}{}{}

Каждый модуль, который изображен на диаграмме, содержит в себе
сгруппированные по функциональному значению соответствующие функции и классы.
Модуль взаимодействия с пользователем отвечает за пользовательский
интерфейс. Модуль управления связывает модули классификации, формирования данных, визуализации результатов и тестирования
а также отвечает за координацию их работы.


\section{Установка программного обеспечения}
Для запуска разработанного программного продукта требуется установить
на ЭВМ интерпретатор для Python 3.11 и создать виртуальное окружение для
ПО. В листинге \ref*{code:text} приведены команды, которые необходимо выполнить для
создания виртуального окружения.

\begin{lstlisting}[label=code:text, language=bash, caption={Команды для установки виртуального окружения}]
    python3 -m pip install -user virtualenv
    python3 -m venv env
    source env/bin/activate
\end{lstlisting}

Используемые в разработке библиотеки, которые необходимы для запуска
ПО, приведены в файле \textbf{requirements.txt}, который находится в корневой директории 
проекта. С помощью пакетного менеджера pip все зависимости нужно
установить, запустив в терминале команду, приведенную в
листинге \ref*{code:text2}.

\begin{lstlisting}[label=code:text2, language=bash, caption={Команда для установки необходимых библиотек}]
    pip3 install -r requirements.txt
\end{lstlisting}


\section{Пользовательский интерфейс}
Графический интерфейс разработан при помощи библотеки PyQt5, предоставляющей набор классов и методов для работы с компонентами интерфейса.
На рисунке \ref*{img:gui} представлен пользовательский интерфейс.

\imgs{gui}{H}{0.45}{Пользовательский интерфейс}{}{}
В колонке <<Предполагаемая атака>> отображаются результаты обнаружения сетевых атак во входном CSV-файле.
В колонке <<Вероятность>> отображается вероятнсть принадлежности атаки к соответствующему классу.

Если пользователь, не выбрав входной файл, нажмет на кнопку <<Обнаружить сетевые атаки>> или на кнопку <<Построить гистограмму>>,
то на экран выведется сообщение об ошибке, как показано на рисунке \ref*{img:er}.
\imgs{er}{H}{0.46}{Сообщение об ошибке}{}{}

При нажатии на кнопку «Выбрать файл» открываются файловая система
устройства, после чего необходимо выбрать интересующий CSV-файл.
После выбора файла, сетевые параметры отобразятся в таблице <<Исходные данные>>.

Если файл выбран, то при нажатии на кнопку <<Обнаружить сетевые атаки>>, запустится алгоритм обнаружения сетевых атак для каждой строки из входного CSV-файла. 
Результат работы алгоритма представлен на рисунке \ref*{img:res}.

\imgs{res}{H}{0.46}{Результат работы}{}{}


При нажатии на кнопку <<Построить гистограмму>> на экран выведется гистограмма,
отображающая количество атак принадлежащих к различным классам сетевых атак.
\imgs{hist2}{H}{0.8}{Распределение сетевых атак}{}{}

В листинге \ref*{code:text3} приведены параметры для взаимодействия с модулем обучения модели.

\begin{lstlisting}[label=code:text3, language=bash, caption={Взаимодействие с модулем модели}]
python3 mlearn.py -h

options:
    -h, --help                show this help message and exit
    --dataroot DATAROOT       путь к датасету
    --batchSize BATCHSIZE     размер выборки данных на каждой итерации
    --nLayers NLAYERS         количество слоев
    --layerSize LAYERSIZE     размер слоя
    --niter NITER             количество эпох для обучения
    --net NET                 путь к сохраненной модели
    --manualSeed MANUALSEED   seed для перемешивания данных
    --stoppingWeightingMethod EAGERSTOPPINGWEIGHTINGMETHOD
                              функция весов
\end{lstlisting}

\section{Тестирование программного обеспечения}
Проведено тестирование программного обеспечения. Тесты приведены в таблице \ref*{tbl:tests}

\begin{center}
    \captionsetup{justification=raggedleft,singlelinecheck=off}
    \begin{longtable}[c]{|P{5cm}|P{6cm}|P{5.2cm}|}
    \caption{Сравнение методов \label{tbl:tests}}
    \\ \hline
        \textbf{Название функции} &
        \textbf{Входные данные} &
        \textbf{Ожидаемый результат} 
    \\ \hline
        filter\_input\_data &
        CSV-файл с информацией о сетевых параметрах &
        Датасет типа pd.DataFrame \cite{pddataframe} с отфильтрованными сетевыми параметрами
    \\ \hline
        predict\_all\_normal &
        pd.DataFrame с данными о нормальном сетвом поведении  &
        Массив данных, все элементы которого принадлежат классу Normal
    \\ \hline
        predict\_all\_ddos\_loit &
        pd.DataFrame с данными о сетевых атаках типа DDoS LOIT &
        Массив данных, все элементы которого принадлежат классу DDoS LOIT
    \\ \hline
        predict\_mix\_attacks &
        pd.DataFrame с данными о всех типах сетевых атаках &
        Массив данных, элементы которого принадлежат соответствующим классам из входного датасета 
    \\ \hline
    predict\_all\_portscan &
    pd.DataFrame с данными о сетевых атаках типа PortScan &
    Массив данных, все элементы которого принадлежат классу PortScan
    \\ \hline
    predict\_all\_ddos\_hulk &
    pd.DataFrame с данными о сетевых атаках типа DDoS Hulk &
    Массив данных, все элементы которого принадлежат классу DDoS Hulk
    \\ \hline
\end{longtable}
\end{center}


\section{Вывод}
Были описаны средства реализации программного комплекса. 
Описаны входные и выходные данные. Описаны технологии и методы, использовавшиеся при реализации.
Определены минимальные требования к вычислительной системе. Приведена инструкция
для установки ПО. Приведено описание интерфейса пользователя. Проведено модульное тестирование.


